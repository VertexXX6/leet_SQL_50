# Write your MySQL query statement below
 -- Problem: For each month and country, find:
--   1. Total number of transactions
--   2. Total transaction amount
--   3. Number of approved transactions
--   4. Total amount of approved transactions
 
-- Approach:
-- - Use DATE_FORMAT(trans_date, '%Y-%m') to extract year-month (ignore day)."case when state='condition' then something else 0 end-"
-- - COUNT(*) to get total transactions per group.
-- - SUM with CASE WHEN to calculate conditional counts and amounts.
-- - GROUP BY month and country to aggregate correctly.

select date_format(trans_date, '%Y-%m')  as month,country , count(*) as trans_count , sum(case when state='approved' then 1 else 0 end) as approved_count, sum(amount) as trans_total_amount, sum(case when state='approved' then amount else 0 end) as approved_total_amount 
from Transactions
group by date_format(trans_date, '%Y-%m') , country;
